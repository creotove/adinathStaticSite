"use strict";(self.webpackChunk_spellgrowth_adi_nath_group=self.webpackChunk_spellgrowth_adi_nath_group||[]).push([[9422],{16559:function(e,s,t){t(72791);var a=t(78983),r=t(80184);s.Z=function(e){var s=e.status,t="pending"===s?"warning":"rejected"===s?"danger":"success",n="pending"===s?"Pending":"rejected"===s?"Rejected":"Approved";return(0,r.jsx)(a.C_,{className:"text-white",color:t,children:n})}},29422:function(e,s,t){t.r(s);var a=t(74165),r=t(1413),n=t(15861),c=t(29439),l=t(72791),i=t(89708),d=t(47022),o=t(89743),u=t(95313),x=t(2677),h=t(16157),m=t(59434),p=t(62649),j=t(31243),N=t(11007),v=t(16559),f=t(80184);s.default=function(){var e=(0,m.v9)((function(e){return e.user.user})),s=(0,l.useState)(!1),t=(0,c.Z)(s,2),Z=t[0],g=t[1],b=(0,l.useState)(0),C=(0,c.Z)(b,2),y=C[0],w=C[1],P=(0,l.useState)(0),S=(0,c.Z)(P,2),I=S[0],q=S[1],k=(0,l.useState)([]),_=(0,c.Z)(k,2),R=_[0],z=_[1],B=(0,m.I0)(),G=function(e){var s=new Date(e);return"".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"),"-").concat(String(s.getDate()).padStart(2,"0")," ").concat(String(s.getHours()).padStart(2,"0"),":").concat(String(s.getMinutes()).padStart(2,"0"),":").concat(String(s.getSeconds()).padStart(2,"0"))},D=function(){var s=(0,n.Z)((0,a.Z)().mark((function s(t){var n,c;return(0,a.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,t.preventDefault(),t.stopPropagation(),""!==y&&0!==y){s.next=6;break}return g(!1),s.abrupt("return",p.ZP.error("Coupon quantity must be greater than 0"));case 6:if(!(y>e.walletBalance/e.couponPrice)){s.next=9;break}return g(!1),s.abrupt("return",p.ZP.error("Insufficient wallet balance"));case 9:return n=y*e.couponPrice,c={userId:e.uniqueId,singleCouponPrice:e.couponPrice,quantity:y},s.next=13,j.Z.post("/api/v1/retailer/initiateCouponPurchase",c);case 13:s.sent.data.success?(p.ZP.success("Coupon purchase request sent successfully"),B((0,N.a)((0,r.Z)((0,r.Z)({},e),{},{walletBalance:e.walletBalance-n}))),L(),g(!1)):g(!1),s.next=20;break;case 17:s.prev=17,s.t0=s.catch(0),console.log(s.t0);case 20:case"end":return s.stop()}}),s,null,[[0,17]])})));return function(e){return s.apply(this,arguments)}}(),L=function(){var s=(0,n.Z)((0,a.Z)().mark((function s(){var t,r;return(0,a.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,t=e._id,s.next=4,j.Z.post("/api/v1/retailer/getPurchaseCouponHistory",{userId:t});case 4:(r=s.sent).data.success?z(r.data.data):p.ZP.error(r.data.message),s.next=10;break;case 8:s.prev=8,s.t0=s.catch(0);case 10:case"end":return s.stop()}}),s,null,[[0,8]])})));return function(){return s.apply(this,arguments)}}();return(0,l.useEffect)((function(){L()}),[]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(i.Z,{show:Z,onHide:function(){return g(!1)},centered:!0,children:[(0,f.jsx)(i.Z.Header,{closeButton:!0,children:(0,f.jsx)(i.Z.Title,{children:"Coupon Request"})}),(0,f.jsx)(d.Z,{className:"p-3",children:(0,f.jsxs)(o.Z,{children:[(0,f.jsx)(u.Z,{noValidate:!0}),(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"col-md-6",children:(0,f.jsxs)(u.Z.Group,{as:x.Z,controlId:"formName",children:[(0,f.jsx)(u.Z.Label,{children:"Coupon"}),(0,f.jsx)(u.Z.Control,{size:"sm",type:"text",placeholder:"P Coupon",disabled:!0,value:"P Coupon",required:!0})]})}),(0,f.jsx)("div",{className:"col-md-6",children:(0,f.jsxs)(u.Z.Group,{as:x.Z,controlId:"formName",children:[(0,f.jsx)(u.Z.Label,{children:"Retailer Id"}),(0,f.jsx)(u.Z.Control,{size:"sm",type:"text",placeholder:"Retailer ID",disabled:!0,value:e&&e.uniqueId,required:!0})]})})]}),(0,f.jsxs)("div",{className:"row mt-2",children:[(0,f.jsxs)(u.Z.Group,{as:x.Z,controlId:"formName",children:[(0,f.jsx)(u.Z.Label,{children:"User Name"}),(0,f.jsx)(u.Z.Control,{size:"sm",type:"text",placeholder:"User Name",disabled:!0,value:e&&e.name,required:!0})]}),(0,f.jsx)("div",{className:"col-md-4",children:(0,f.jsxs)(u.Z.Group,{as:x.Z,controlId:"formName",children:[(0,f.jsx)(u.Z.Label,{children:"Coupon Quantity"}),(0,f.jsx)(u.Z.Control,{size:"sm",type:"number",placeholder:"Enter Coupon quantity",onChange:function(s){!function(s){var t=s.target.value;/^-?\d*$/.test(t)&&(w(t),q(t*e.couponPrice))}(s)},value:y,required:!0})]})})]}),(0,f.jsxs)("div",{className:"row mt-2",children:[(0,f.jsx)("div",{className:"col-md-6",children:(0,f.jsxs)(u.Z.Group,{as:x.Z,controlId:"formName",children:[(0,f.jsx)(u.Z.Label,{children:"Single Coupon Price"}),(0,f.jsx)(u.Z.Control,{size:"sm",type:"number",placeholder:"Enter Coupon quantity",value:e&&e.couponPrice,disabled:!0,required:!0})]})}),(0,f.jsx)("div",{className:"col-md-6",children:(0,f.jsxs)(u.Z.Group,{as:x.Z,controlId:"formName",children:[(0,f.jsx)(u.Z.Label,{children:"Total Amount"}),(0,f.jsx)(u.Z.Control,{size:"sm",type:"number",placeholder:"Total Amount",value:I,disabled:!0,required:!0})]})})]})]})}),(0,f.jsx)("div",{className:"m-4",children:(0,f.jsx)(d.Z,{className:"d-flex justify-content-end",children:(0,f.jsx)(h.Z,{className:"myCustomBtn",onClick:D,children:"Purchase"})})})]}),(0,f.jsxs)(d.Z,{fluid:!0,className:"mb-3",children:[(0,f.jsx)("div",{className:"content-header mt-1",children:(0,f.jsxs)("div",{className:"row mb-2",children:[(0,f.jsx)("div",{className:"col-sm-6"}),(0,f.jsx)("div",{className:"col-sm-6",children:(0,f.jsx)("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end ",children:(0,f.jsxs)(h.Z,{className:"myCustomBtn",onClick:function(){g(!0)},children:[(0,f.jsx)("i",{className:"fas fa-plus"})," Purchase Coupon"]})})})]})}),(0,f.jsx)("div",{className:"row",children:(0,f.jsx)("div",{className:"col-md-12",children:(0,f.jsxs)("div",{className:"card",children:[(0,f.jsx)("div",{className:"card-header",children:(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"col-md-8 col-lg-8 col-xl-8",children:(0,f.jsx)("h3",{className:"card-title",children:"Coupons"})}),(0,f.jsx)("div",{className:" col-md-2 col-lg-2 col-xl-2"})]})}),(0,f.jsx)("div",{className:"card-body table-responsive p-0",style:{height:450},children:(0,f.jsxs)("table",{className:"table table-head-fixed text-nowrap",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{className:"text-center",children:"SN"}),(0,f.jsx)("th",{className:"text-center",children:"Date & Time"}),(0,f.jsx)("th",{className:"text-center",children:"Req By"}),(0,f.jsx)("th",{className:"text-center",children:"Retailer Id"}),(0,f.jsx)("th",{className:"text-center",children:"Qty"}),(0,f.jsx)("th",{className:"text-center",children:"Price"}),(0,f.jsx)("th",{className:"text-center",children:"Single Coupon Price"}),(0,f.jsx)("th",{className:"text-center",children:"Status"})]})}),(0,f.jsx)("tbody",{children:R&&R.length>0?R.map((function(s,t){return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"text-center",children:t+1}),(0,f.jsx)("td",{className:"text-center",children:G(s.purchaseDate)}),(0,f.jsx)("td",{className:"text-center",children:s.retailerId.name}),(0,f.jsx)("td",{className:"text-center",children:s.retailerId.uniqueId}),(0,f.jsx)("td",{className:"text-center",children:s.quantity}),(0,f.jsx)("td",{className:"text-center",children:s.totalPrice}),(0,f.jsx)("td",{className:"text-center",children:e&&e.couponPrice}),(0,f.jsx)("td",{className:"text-center",children:(0,f.jsx)(v.Z,{status:s.status})})]},t)})):(0,f.jsx)("tr",{children:(0,f.jsx)("td",{colSpan:9,className:"text-center text-danger",children:"No data found"})})})]})})]})})})]})]})}},89743:function(e,s,t){var a=t(1413),r=t(45987),n=t(81694),c=t.n(n),l=t(72791),i=t(10162),d=t(80184),o=["bsPrefix","className","as"],u=l.forwardRef((function(e,s){var t=e.bsPrefix,n=e.className,l=e.as,u=void 0===l?"div":l,x=(0,r.Z)(e,o),h=(0,i.vE)(t,"row"),m=(0,i.pi)(),p=(0,i.zG)(),j="".concat(h,"-cols"),N=[];return m.forEach((function(e){var s,t=x[e];delete x[e],s=null!=t&&"object"===typeof t?t.cols:t;var a=e!==p?"-".concat(e):"";null!=s&&N.push("".concat(j).concat(a,"-").concat(s))})),(0,d.jsx)(u,(0,a.Z)((0,a.Z)({ref:s},x),{},{className:c().apply(void 0,[n,h].concat(N))}))}));u.displayName="Row",s.Z=u}}]);
//# sourceMappingURL=9422.33a47296.chunk.js.map